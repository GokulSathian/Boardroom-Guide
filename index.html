<!-- index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Boardroom Guide</title>
  
  <!-- React via CDN -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link rel="stylesheet" href="style.css" />

</head>
<body>
  <!-- Main container for the entire application -->
  <div id="app-root"></div>

  <footer class="footer">
    <small>Boardroom — Minimal guide · Tap any button to start</small>
  </footer>

  <!-- All React logic is now in this single script -->
  <script type="text/babel" src="script.js"></script>
  
  <script type="text/babel">
    // script.js - Refactored with React
    'use strict';

    const { useState, useRef } = React;

    // --- Data for both flows ---
    const flowData = {
      owl: {
        title: "How to use OWL (Audio and Visual) ",
        cards: [
          {
            id: 1,
            title: "Step 1:Plug-in the power cord to the Owl",
            content: "Plug into the nearest power socket",
            gifUrl: "images/How to use Owl 2.jpg"
          },
          {
            id: 2,
            title: "Step 2: Check the Lights on Owl",
            content: "",
            gifUrl: "images/How to use Owl 1.jpg"
          },
                    {
            id: 3,
            title: "Step 3: Plug in the Mic to the OWL",
            content: "",
            gifUrl: "images/How to use Owl 3.jpg"
          },
          {
            id: 4,
            title: "Step 4: Then plug in the cord to the Mic",
            content: "",
            gifUrl: "images/How to use Owl 4.jpg"
          },
          {
            id: 5,
            title: "Step 5: Plug in the USB-C cord to the OWL",
            content: "",
            gifUrl: "images/How to use Owl 5.jpg"
          },
          {
            id: 6,
            title: "Step 6: Then plug in your Laptop",
            content: "",
            gifUrl: "images/How to use Owl 6.jpg"
          },
          {
            id: 7,
            title: "Step 7: Once your meeting is open check your Audio Settings",
            content: "",
            gifUrl: "images/How to use Owl 7.jpg"
          },
          {
            id: 8,
            title: "Step 8: Once Audio Settings are open ensure they are both connected to ECHO CANCELLING SMARTPHONE MEETING OWL 4 PLUS",
            content: "",
            gifUrl: "images/How to use Owl 8.jpg"
          }
        ]
      },
      cast: {
        title: "How to Cast/Screenshare (No sound)",
        cards: [
          {
            id: 1,
            title: "Step1: Turn on the TV - Go into Settings and scroll to see if WIFI is connected. Ensure your Laptop is on the same WIFI",
            content: "Ensure TV and Laptop are on same Wifi",
            gifUrl: "images/Cast screen1.jpg"
          },
          {
            id: 2,
            title: "Step 2: Select CAST in your task bar and hit ENTER on Connect to a wireless display",
            content: "Use Search bar in your Laptop",
            gifUrl: "images/Cast screen2.jpg"
          },
          {
            id: 3,
            title: "Step 3: Select Connect beside Connect to a wireless display",
            content: "Click on Connect",
            gifUrl: "images/Cast screen3.jpg"
          },
          {
            id: 4,
            title: "Step 4: Select which TV you would like to cast to Boardroom Right TV OR Boardroom Left TV",
            content: "Select from Board Room Right or Left TV",
            gifUrl: "images/Cast screen4.jpg"
          },
          {
            id: 5,
            title: "Step 5: Once selected it will cast your laptop screen on the TV",
            content: `Successfully Casted`,
            gifUrl: "images/Cast screen5.jpg"
          }

        ]
      },
      mac: {
        title: "Owl+Mini",
        cards: [
          {
            id: 1,
            title: "Step 1:Turn On the Mac mini",
            content: "",
            gifUrl: "images/Mini 1.jpeg"
          },
          {
            id: 2,
            title: "Step 2: Select the correct User",
            content: "",
            gifUrl: "images/Mini 2.jpeg"
          },
          {
            id: 3,
            title: "Step 3: Select Owl lab application",
            content: "",
            gifUrl: "images/Mini 3.jpeg"
          },
          {
            id: 5,
            title: "Step 5: Inside application go to settings > paired device",
            content: "Before this step make sure you plug in the Owl and Mic to it",
            gifUrl: "images/Mini 5.jpeg"
          },
          {
            id: 6,
            title: "Step 6: Connecting Owl Bar and Owl, Click on next",
            content: "Owl bar is already connected to Mac mini",
            gifUrl: "images/Mini 6.jpeg"
          },
          {
            id: 7,
            title: "Step 7: Click on Find Nearby Device",
            content: "",
            gifUrl: "images/Mini 7.jpeg"
          },
          {
            id: 8,
            title: "Step 8: The OWL device shows up on screen select it and click on Pair Device",
            content: "",
            gifUrl: "images/Mini 9.jpeg"
          },
          {
            id: 10,
            title: "Step 10: You will see the Success Message",
            content: "",
            gifUrl: "images/Mini 10.jpeg"
          },
          {
            id: 11,
            title: "Step 11: Start Your Meeting",
            content: "You are all set! The Owl Bar will now intelligently focus on the speaker.",
            gifUrl: "images/Mini 11.jpeg"
          },
          {
            id: 12,
            title: "Step 12: Start Your Meeting",
            content: "You are all set! The Owl Bar will now intelligently focus on the speaker.",
            gifUrl: "images/Mini 12.jpeg"
          },
          {
            id: 13,
            title: "Step 13: Start Your Meeting",
            content: "You are all set! The Owl Bar will now intelligently focus on the speaker.",
            gifUrl: "images/Mini 13.jpeg"
          },
          {
            id: 14,
            title: "Step 13: Click on Finish and You are Ready to Start a Meeting",
            content: "Use Zoom or Teams for your meeting",
            gifUrl: "images/Mini 14.jpg"
          }
        ]
      }
    };


    // --- React Components ---

    function StackedCards({ cards, onBack }) {
      const [activeIndex, setActiveIndex] = useState(0);
      
      // --- Refs for Swipe Gesture ---
      const touchStartX = useRef(null);
      const touchEndX = useRef(null);
      const minSwipeDistance = 50; // Minimum distance in pixels for a swipe to be registered

      // --- Touch Handlers for Mobile Swipe ---

      // Captures the starting X position of the touch
      const onTouchStart = (e) => {
        touchEndX.current = null; // Reset end position on new touch
        touchStartX.current = e.targetTouches[0].clientX;
      };

      // Updates the end X position as the user's finger moves
      const onTouchMove = (e) => {
        touchEndX.current = e.targetTouches[0].clientX;
      };

      // Calculates the swipe direction and distance when the touch ends
      const onTouchEnd = () => {
        if (!touchStartX.current || !touchEndX.current) return;
        const distance = touchStartX.current - touchEndX.current;
        const isRightSwipe = distance < -minSwipeDistance; // Swipe right
        const isLeftSwipe = distance > minSwipeDistance;  // Swipe left

        // If swiped left, go to the next card
        if (isLeftSwipe && activeIndex < cards.length - 1) {
          setActiveIndex(activeIndex + 1);
        // If swiped right, go to the previous card
        } else if (isRightSwipe && activeIndex > 0) {
          setActiveIndex(activeIndex - 1);
        }

        // Reset touch positions for the next swipe
        touchStartX.current = null;
        touchEndX.current = null;
      };

      const handleNext = () => {
        if (activeIndex < cards.length - 1) setActiveIndex(activeIndex + 1);
      };

      const handlePrev = () => {
        if (activeIndex > 0) setActiveIndex(activeIndex - 1);
      };

      return (
        <div
          className="stacked-cards-container"
          onTouchStart={onTouchStart}
          onTouchMove={onTouchMove}
          onTouchEnd={onTouchEnd}
        >
          {cards.map((card, index) => {
            const offset = index - activeIndex;
            const isVisible = offset >= 0 && offset < 3;

            return (
              <div
                key={card.id}
                className={`card ${offset === 0 ? 'card--active' : ''}`}
                style={{
                  transform: `translateY(${offset * 30}px) scale(${1 - Math.abs(offset) * 0.05})`,
                  opacity: isVisible ? 1 : 0,
                  zIndex: 10 - offset,
                  pointerEvents: offset === 0 ? 'auto' : 'none'
                }}
              >
                <h2 className="card-title">{card.title}</h2>
                {card.gifUrl && (
                  <img
                    src={card.gifUrl}
                    alt="Step guidance"
                    className="card-media"
                  />
                )}
                <div className="card-content">{card.content}</div>
              </div>
            );
          })}

          <div className="nav-controls">
            <div className="nav-buttons">
              <button onClick={handlePrev} disabled={activeIndex === 0} className="nav-button nav-button--prev">
                Prev
              </button>
              <div className="dots-container">
              {cards.map((_, index) => (
                <button
                  key={index}
                  onClick={() => setActiveIndex(index)}
                  className={`dot ${activeIndex === index ? "dot--active" : ""}`}
                  aria-label={`Go to step ${index + 1}`}
                />
              ))}
            </div>
              <button onClick={handleNext} disabled={activeIndex === cards.length - 1} className="nav-button nav-button--next">
                Next
              </button>
            </div>
          </div>
        </div>
      );
    }

    function HomeScreen({ onSelectFlow }) {
      return (
        <main className="app app--centered">
          <header className="brand" role="banner">
           <img src="images/Bill-Gosling-logo.jpg" alt="Bill Gosling Company Logo" className="brand__logo" />
            <div className="brand__meta">
              <h1 className="brand__title">Boardroom Guide</h1>
              <p className="brand__subtitle">Quick steps to set up the Owl Bar & cast your screen</p>
            </div>
          </header>
          <section className="home-card" aria-labelledby="home-heading">
            <h2 id="home-heading" className="visually-hidden">Choose a flow</h2>
            <div className="home-actions">
              <button onClick={() => onSelectFlow('owl')} className="action-button" aria-label="How to use OWL (Audio and Visual) ">
                <span className="action-button__emoji" aria-hidden="true">🔌</span>
                <span className="action-button__label">How to use OWL (Audio and Visual) </span>
              </button>
              <button onClick={() => onSelectFlow('cast')} className="action-button" aria-label="How to Cast/Screenshare (No sound)">
                <span className="action-button__emoji" aria-hidden="true">📺</span>
                <span className="action-button__label">How to Cast/Screenshare (No sound)</span>
              </button>
              <button onClick={() => onSelectFlow('mac')} className="action-button" aria-label="Owl+Mini">
                <span className="action-button__emoji" aria-hidden="true">💻</span>
                <span className="action-button__label">Owl+Mini</span>
              </button>
            </div>
            <p className="hint">Tap a flow to view step-by-step instructions.</p>
          </section>
        </main>
      );
    }

    function FlowScreen({ flow, onBack }) {
      return (
        <main className="app">
          <header className="flow-header">
            <button className="back-button" onClick={onBack} aria-label="Back to home">‹ Back</button>
            <h1>{flow.title}</h1>
          </header>
          <StackedCards cards={flow.cards} onBack={onBack} />
        </main>
      );
    }


    function App() {
      const [activeFlow, setActiveFlow] = useState(null); // 'owl', 'cast', or null

      const handleSelectFlow = (flowName) => {
        setActiveFlow(flowName);
      };

      const handleGoHome = () => {
        setActiveFlow(null);
      };

      if (activeFlow) {
        return <FlowScreen flow={flowData[activeFlow]} onBack={handleGoHome} />;
      }

      return <HomeScreen onSelectFlow={handleSelectFlow} />;
    }


    const container = document.getElementById('app-root');
    const root = ReactDOM.createRoot(container);
    root.render(<App />);
  </script>
</body>
</html>
